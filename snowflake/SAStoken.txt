-- creating database and warehouse --

use role sysadmin;

create database if not exists playdb;

create warehouse if not exists playwh with warehouse_size='xsmall' auto_suspend=60 initially_suspended=true;

use schema playdb.public;

-- cloud storage integration --

use role accountadmin;




create storage integration azure_snowflake_integration_171_4
      type = external_stage
      storage_provider = azure
      enabled = true
      azure_tenant_id = 'tenant_id'
      storage_allowed_locations = ('*');
      
grant usage on integration azure_snowflake_integration_171_4 to sysadmin;

describe storage integration azure_snowflake_integration_171_4;


use role sysadmin;


create or replace file format my_csv_format_2
      type = csv
      field_delimiter = '|'
      skip_header = 1
      null_if = ('NULL', 'null')
      empty_field_as_null = true
      compression = gzip;


CREATE OR REPLACE STAGE my_azure_stage_sas
  URL='azure://*.blob.core.windows.net/container'
  CREDENTIALS=(AZURE_SAS_TOKEN='?sastoken')
  FILE_FORMAT = my_csv_format_2;
      
    
    
    list @my_azure_stage_sas;
